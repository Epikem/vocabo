version: '2'

services:
  server:
    build:
      context: ./server/
    command: npm start
    volumes:
      - ./server/:/usr/app
      - /usr/app/node_modules
    depends_on:
      - elastic
    links:
      - elastic:elastic-url
    ports:
      - "3001:3001"
    environment:
      - ELASTICSEARCH_URL=http://elastic-url:9200
      - NODE_ENV=production
  client: #TODO: use static build
    build:
      context: ./client/
    command: npm start
    volumes:
      - ./client/:/usr/app
      - /usr/app/node_modules
    depends_on:
      - server
    ports:
      - "3000:3000"